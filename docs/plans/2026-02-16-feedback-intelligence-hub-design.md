# Feedback Intelligence Hub + Tester Activity

**Date:** 2026-02-16
**Status:** Approved
**Target audience:** Solo founders managing beta testers

## Problem

The dashboard currently shows pipeline "output" (runs, PRs, deployments) but not the "input" (actual feedback conversations) or the "story" (themes, trends, coverage gaps). Founders can't see what beta testers are saying at a high level or identify which app areas lack testing.

## Solution

A Feedback Intelligence Hub that stores all widget conversations in Supabase, uses Claude Haiku to cluster feedback into themes, and surfaces a digest + tester activity view.

## Architecture Decision: AI Processing

**Chosen: Option 1 â€” Direct Claude Haiku calls from Next.js API routes.**

- When a conversation ends (no new messages for 10 min) or has 3+ messages, a Next.js API route calls Claude Haiku
- Input: full conversation text + project's existing theme list
- Output: one-line summary, 1-3 theme tags, app area classification
- Digest generation: separate Haiku call with all recent conversations/themes
- ~500 tokens per classification call, ~$0.10 per 100 conversations/week
- No extra infrastructure needed (no Edge Functions, no vector store)

## Data Layer

### New Supabase Tables

**`feedback_sessions`**

| Column | Type | Notes |
|--------|------|-------|
| `id` | uuid | PK |
| `project_id` | uuid | FK â†’ projects |
| `tester_id` | text | nullable, from widget auth |
| `tester_name` | text | nullable |
| `started_at` | timestamptz | |
| `last_message_at` | timestamptz | |
| `message_count` | int | |
| `ai_summary` | text | nullable, generated by Haiku |
| `ai_themes` | jsonb | nullable, array of theme IDs |
| `github_issue_number` | int | nullable, linked issue |
| `status` | text | open / resolved / dismissed |

**`feedback_messages`**

| Column | Type | Notes |
|--------|------|-------|
| `id` | uuid | PK |
| `session_id` | uuid | FK â†’ feedback_sessions |
| `role` | text | user / assistant |
| `content` | text | |
| `created_at` | timestamptz | |

**`feedback_themes`**

| Column | Type | Notes |
|--------|------|-------|
| `id` | uuid | PK |
| `project_id` | uuid | FK â†’ projects |
| `name` | text | e.g. "Checkout UX" |
| `description` | text | AI-generated |
| `color` | text | hex, auto-assigned from palette |
| `message_count` | int | conversations linked to this theme |
| `last_seen_at` | timestamptz | |

### Data Flow

1. Widget sends messages to `/api/feedback/chat` (existing route)
2. Chat handler now also POSTs each message to `feedback_messages` + updates `feedback_sessions`
3. After conversation idle (10 min) or 3+ messages: API route calls Claude Haiku for classification
4. Haiku returns summary + themes â†’ written back to `feedback_sessions.ai_summary` and `ai_themes`
5. Theme registry (`feedback_themes`) updated: existing themes reused, new ones created

## UI: Feedback Inbox Page

New primary page in the sidebar (above Runs in nav priority).

### Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Sidebar]  â”‚  Feedback                    [Filter â–¾] â”‚
â”‚             â”‚                                          â”‚
â”‚  Dashboard  â”‚  â”Œâ”€ Digest Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  Feedback â† â”‚  â”‚ "This week: 14 conversations.     â”‚  â”‚
â”‚  Runs       â”‚  â”‚  Top theme: Checkout UX (6).       â”‚  â”‚
â”‚  Settings   â”‚  â”‚  3 need attention. No feedback on  â”‚  â”‚
â”‚             â”‚  â”‚  Settings page."          [Refresh] â”‚  â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚             â”‚                                          â”‚
â”‚             â”‚  â”Œâ”€ Theme Pills â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚             â”‚  â”‚ [Login (4)] [Checkout (6)] [UI (3)]â”‚  â”‚
â”‚             â”‚  â”‚ [Feature Req (1)]                   â”‚  â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚             â”‚                                          â”‚
â”‚             â”‚  â”Œâ”€ Conversation List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚             â”‚  â”‚ ğŸŸ¢ "Checkout button doesn't..."   â”‚  â”‚
â”‚             â”‚  â”‚    alex Â· 2h ago Â· Checkout UX     â”‚  â”‚
â”‚             â”‚  â”‚ ğŸŸ¡ "Would be nice to have..."     â”‚  â”‚
â”‚             â”‚  â”‚    tester3 Â· 5h ago Â· Feature Req  â”‚  â”‚
â”‚             â”‚  â”‚ âœ… "The login page is broken on..."â”‚  â”‚
â”‚             â”‚  â”‚    maria Â· 1d ago Â· Login Â· Resolvedâ”‚  â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚             â”‚                                          â”‚
â”‚             â”‚  Click â†’ Slide-over with full thread     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Elements

- **Digest card** â€” AI-generated summary, refreshable, cached 30 min
- **Theme pills** â€” clickable filters, color-coded, show conversation count
- **Conversation list** â€” AI summary (one line), tester name, time, theme tag, status
- **Slide-over** â€” full message thread, linked issue/PR, actions (dismiss, resolve, escalate)

### Status Indicators

- ğŸŸ¢ Green dot: new/open, needs attention
- ğŸŸ¡ Yellow dot: in progress (issue created, agent working)
- âœ… Green checkmark: resolved (PR merged)
- âšª Gray: dismissed

## UI: Tester Activity View

Secondary view accessible from the Feedback page (tab or toggle).

### Tester Cards

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Testers (7 active this week)               â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€ Tester Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ alex                                    â”‚ â”‚
â”‚  â”‚ 12 conversations Â· Last active 2h ago   â”‚ â”‚
â”‚  â”‚ Top themes: Checkout (5), UI (3)        â”‚ â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 85% resolved             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€ Tester Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ maria                                   â”‚ â”‚
â”‚  â”‚ 8 conversations Â· Last active 1d ago    â”‚ â”‚
â”‚  â”‚ Top themes: Login (4), Performance (2)  â”‚ â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 62% resolved             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Each card shows: name, total conversations, last active, top themes, resolution rate.
Click â†’ filters the feedback inbox to that tester's conversations.

## UI: Digest Generation

### Appears in

- Top of Feedback page (digest card)
- Main project dashboard page (summary card)

### Content

- Total conversations this period (day/week toggle)
- Top 3 themes with counts
- Items needing attention (unresolved, high-frequency)
- Blind spots (areas with no feedback)
- Notable changes ("Checkout feedback up 200% this week")

### Refresh

- Cached, regenerates every 30 min
- Manual refresh button
- Future: daily email digest

## Widget Changes Required

1. Chat handler (`createFeedbackHandler`) gains Supabase integration: POST messages to `feedback_messages` + manage `feedback_sessions`
2. Optional "name" field in widget auth prompt for tester identification
3. Project API key used to authenticate widget â†’ Supabase writes

## Non-Goals (for now)

- Real-time WebSocket updates (polling is fine)
- Email/push notifications
- Public changelog generation
- Widget appearance customization from dashboard
